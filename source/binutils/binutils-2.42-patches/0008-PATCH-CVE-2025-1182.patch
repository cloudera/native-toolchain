From b425859021d17adf62f06fb904797cf8642986ad Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Wed, 5 Feb 2025 16:27:38 +0000
Subject: [PATCH] Fix another illegal memory access triggered by corrupt ELF
 input files.

PR 32644
---
 bfd/elflink.c | 4 ++++
 1 file changed, 4 insertions(+)

Index: binutils-2.42/bfd/elflink.c
===================================================================
--- binutils-2.42.orig/bfd/elflink.c
+++ binutils-2.42/bfd/elflink.c
@@ -14895,6 +14895,10 @@ bfd_elf_reloc_symbol_deleted_p (bfd_vma
 	}
       else
 	{
+	  if (r_symndx >= rcookie->locsymcount)
+	    /* This can happen with corrupt input.  */
+	    return false;
+
 	  /* It's not a relocation against a global symbol,
 	     but it could be a relocation against a local
 	     symbol for a discarded section.  */
